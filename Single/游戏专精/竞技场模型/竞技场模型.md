---
title: 竞技场模型
date: 
tags:
categories:
attachments: 
  - 竞技场模型.xlsx
---

炉石传说竞技场的规则为三败出局，最高12次胜利，12次胜利后无法再开局。如果一个人的胜率为75%，那他开始一次竞技场在结束后胜利场次的数学期望是多少？

,胜率恒定为p ,然后赢w 局或输l 局终止

求总的局数的期望...解答过程有点长,先给你看个数值上的答案吧:



![](https://pic4.zhimg.com/80/v2-8de561f96910b233d9b99448d56a015c_hd.jpg)

平均进行局数是右下角10.24局,此时期望胜7.68场,败2.56场

12胜情况下平均要进行13.44局比赛,另外成功的概率只有28%...

平均要打9场的样子会挑战失败......

要保证每局82%的成功率才能保证50%的可能性完成挑战



第一反应马尔科夫状态链...然后想到一共wl 个状态...写出来运算量大了点...

再想想发觉自己想多了,过程无关啊,只和结果有关...

最后一局赢的时候,前面必须赢w-1 局,然后允许输0 \sim l-1 局.

一共是 $\displaystyle\sum\limits_{l = 0}^{l - 1} {C_{w + l - 1}^{w - 1}}$ 种情况,反之最后一局是败同理 $\displaystyle\sum\limits_{w = 0}^{w - 1} {C_{w + l - 1}^{l - 1}}$ 种情况...

总的情况数就是 $\displaystyle\sum\limits_{l = 0}^{l - 1} {C_{w + l - 1}^{w - 1}} + \sum\limits_{w = 0}^{w - 1} {C_{w + l - 1}^{l - 1}} = \frac{{\Gamma (l + w + 1)}}{{\Gamma (l + 1)\Gamma (w + 1)}}$种.

---


然后把概率分进去求和

还是根据最后一局胜败分类:


$$\begin{aligned}
P(L)&= (1 - p)\sum\limits_{w = 0}^{w - 1} {C_{w + l - 1}^{l - 1}{p^w}{{(1 - p)}^{l - 1}}}\\
    &= {(1 - p)^l}\sum\limits_{w = 0}^{w - 1} {C_{w + l - 1}^{l - 1}{p^w}} \\ 
    &= {(1 - p)^l}\left( {{{(1 - p)}^{ - l}} - {p^w}C_{w + l - 1}^{l - 1}{_2}{F_1}(1,l + w;w + 1;p)} \right)\\
    &= 1 - wC_{w + l - 1}^{l - 1}{B_p}(w,l)\\
P(W)&= p\sum\limits_{l = 0}^{l - 1} {C_{w + l - 1}^{w - 1}} {p^{w - 1}}{(1 - p)^l}\\
    &= 1 - {(1 - p)^l}{p^w}C_{w + l - 1}^{w - 1}{_2}{F_1}(1,l + w;l + 1;1 - p)\\
    &= 1 - P(L)\\
\end{aligned}$$

--

接下来期望和直接求和即可:

$$\begin{aligned} 
EL &= \sum\limits_{w = 0}^{w - 1} {(w + l)(1 - p)C_{w + l - 1}^{w - 1}{p^w}{{(1 - p)}^{l - 1}}} \\ 
EW &= \sum\limits_{l = 0}^{l - 1} {(w + l)pC_{w + l - 1}^{w - 1}{p^{w - 1}}{{(1 - p)}^l}}\\ 
E(L) &= p(EL + EW)  \\ 
E(W) &= (1 - p)(EL + EW)\\
\end{aligned}$$

---

我们还有另外一种求期望的思路

$p(k)$ 为第 $k$ 场失败出局的概率，算期望时从 $1$ 算到 $w$ 就行了。

$$p(k) = C_{k-2}^2×p^{k-1}×(1-p)^l$$

平均胜利场数:

$$\sum_{k=l+1}^{l+w-1}(k-l)p(k)+w×\sum_{k=l + w}^{\infty}p(k)$$

平均失败场数: 



f[k_] := Binomial[k - 1, 2]*(p)^(k - l)*(1 - p)^l


Sum[(k - l)*f[k], {k, l + 1, l + w - 1}] + 
w*Sum[f[k], {k, l + w, \[Infinity]}] // FullSimplify




最终能打完 12 场的概率为:

$$P(W)=w \binom{l+w-1}{l-1} B_p(w,l)$$

令 $(w,l) = (12,3)$, 则有: $P(W) = 1092 B_p(12,3)$, 我们可以画出曲线图:


如图所示, 单场胜率 $81.5\%$ 才有超过 50% 的概率能赢完 $12$ 场.

单场胜率 $60\%$ 只有 4% 的概率能赢完 $12$ 场, 洗洗睡吧.
